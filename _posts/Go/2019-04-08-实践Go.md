---
layout: post
title: "实践Go"
date: 2019-04-08 11:08:00 +0800
categories: Go
tags: Go
---





main函数

```go

```



## 安装

下载解压，设置环境变量（GOROOT）即可完成安装。

```shell
export GOROOT=/usr/local/go
export PATH=$PATH:$GOROOT/bin
```

设置go工作目录（GOPATH）

```shell
export GOPATH=~/GoProjects
PATH="$GOPATH/bin:$PATH"
```

工作目录结构

```shell
GoProjects$ tree -L 1
.
├── bin
├── pkg
└── src
```

src存放源代码，目录即为包（跟Java类似），pkg存放go编译生成的文件，bin存放安装后的可执行文件

## 快速开始

新建hello项目，项目结构如下：

```shell
GoProjects$ tree
.
├── bin
├── pkg
└── src
    └── ray.wang
        └── hello
            └── main.go

```

main.go

```
package main

import (
	"fmt"
)

func main() {
	fmt.Println("Hello World")
}
```

### 运行

```shell
$ go run main.go
```

### 安装

```shell
# 生成hello文件存放于bin目录
$ go install ray.wang/hello

$ hello
Hello World
```

### 跨平台编译

```shell
$ go env
GOARCH="amd64"
GOBIN=""
GOCACHE="/home/ray/.cache/go-build"
GOEXE=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="linux"
GOOS="linux"
GOPATH="/home/ray/GoProjects"
GOPROXY=""
GORACE=""
GOROOT="/home/ray/platform/go"
GOTMPDIR=""
GOTOOLDIR="/home/ray/platform/go/pkg/tool/linux_amd64"
GCCGO="gccgo"
CC="gcc"
CXX="g++"
CGO_ENABLED="1"
GOMOD=""
CGO_CFLAGS="-g -O2"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-g -O2"
CGO_FFLAGS="-g -O2"
CGO_LDFLAGS="-g -O2"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build887930678=/tmp/go-build -gno-record-gcc-switches"
```

注意里面两个重要的环境变量`GOOS`和`GOARCH`,其中`GOOS`指的是目标操作系统，它的可用值为：

1. darwin
2. freebsd
3. linux
4. windows
5. android
6. dragonfly
7. netbsd
8. openbsd
9. plan9
10. solaris

一共支持10中操作系统。`GOARCH`指的是目标处理器的架构，目前支持的有：

1. arm
2. arm64
3. 386
4. amd64
5. ppc64
6. ppc64le
7. mips64
8. mips64le
9. s390x

```
GOOS=windows GOARCH=amd64 go build ray.wang/hello
```

### 获取远程包

获取

```shell
$ go get -v github.com/spf13/cobra/cobra
```

更新远程包

```shell
$ go get -u -v github.com/spf13/cobra/cobra
```

### 获取Gitlab私有包

设置私服地址http到git转换

```shell
$ git config --global url."git@git.flysnow.org:".insteadOf "http://git.flysnow.org/"
```



```shell
$ go get -v -insecure git.flysnow.org/hello
```

## 基础

### 变量

```go
// 未初始化的变量的值为零值（zero value）
var 变量名 类型 [= 表达式]
类型 := 表达式
```

### 类型

bool

数字类型

string

### 常量

```go
// 省略类型则是无类型的常量
const 变量名 [类型] = 表达式
```

无类型的常量有一个与它们相关联的默认类型，并且当且仅当一行代码需要时才提供它。常量可以赋值给 “合适的” 类型，而不需要类型转换。

### 类型转换

go对于变量的类型有严格的限制，不同类型之间的变量不能进行赋值、表达式等操作，必须要要转换成同一类型才可以。把 v 转换为 T 类型的语法是 T(v)

### 包

```go
package main
package abc
```

* 以包为单位组织模块
* 一个目录（不包含子目录）代表一个包
* 一个目录（不包含子目录）下的文件的包名必须相同
* 包名一般取目录名，也可以跟目录名不通
* 引用时取全路径目录名
* main是一个特殊的包名，它表示当前是一个可执行程序，而不是一个库

```go
import "fmt"
import (
	"github.com/spf13/hugo/commands"
	"io"
)
```

引用包但是不使用包会报错，可以使用空白标识符，会执行包的初始化

```go
import (  
    "geometry/rectangle" 
)

var _ = rectangle.Area // 错误屏蔽器
```

或

```go
import (
    _ "geometry/rectangle" 
)
```



### 函数

```go
func functionname(parametername type) returntype {  
    // 函数体（具体实现的功能）
}
```



#### init函数

包可以包含一个init函数，不包含参数和返回值，用于包的初始化，只会被初始化一次，不能显示调用

```go
func init() {  
}
```



#### main函数

```go
package main

import "fmt"

func main() {
        fmt.Print("Hello, World!")
}
```

### 大小写标记访问权限

大些字母开头的变量或者函数等是public的，可以被其他包访问；小些的则是private的，不能被其他包访问到

### 方法

方法其实就是一个函数，在 `func` 这个关键字和方法名中间加入了一个特殊的接收器类型。接收器可以是结构体类型或者是非结构体类型。接收器是可以在方法的内部访问的。

```go
func (t Type) methodName(parameter list) {
}
```



## 参考

[Go语言中文网（Golang中文社区）](https://studygolang.com)

[Go 系列教程](https://studygolang.com/subject/2)或[Golang tutorial series](https://golangbot.com/learn-golang-series/)

[Go语言环境搭建详解](https://www.flysnow.org/2017/01/05/install-golang.html)

[从Java到Golang快速入门](https://www.flysnow.org/2016/12/28/from-java-to-golang.html)

